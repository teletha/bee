name: Disable Merge Commit

on:
  push:
    branches:
      - main
    paths:
      - ".github/workflows/bee-rule.yml"

permissions:
  contents: write
  actions: write

jobs:
  disable_merge_commit:
    runs-on: ubuntu-latest
    steps:
      - name: Disable merge commits
        run: |
          curl -X PATCH -H "Accept: application/vnd.github.v3+json" \
               -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
               https://api.github.com/repos/${{ github.repository }} \
               -d '{
                 "allow_merge_commit": false,
                 "allow_squash_merge": true,
                 "allow_rebase_merge": true
               }'
